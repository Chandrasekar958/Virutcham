<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cart - Virutcham Exports</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 700px;
      margin: 20px auto;
      padding: 20px;
      background: #fff;
      border-radius: 10px;
    }
    h1 {
      color: #232f3e;
      text-align: center;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 15px;
    }
    th, td {
      border-bottom: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
    th {
      background-color: #febd69;
      color: #111;
    }
    .address-form label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
    }
    .address-form input {
      width: 100%;
      padding: 8px;
      margin-top: 4px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    .payment-buttons {
      margin-top: 20px;
      text-align: center;
    }
    .payment-buttons button {
      background-color: #febd69;
      border: none;
      padding: 12px 25px;
      margin: 0 10px;
      font-size: 1rem;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      transition: background-color 0.3s ease;
    }
    .payment-buttons button:hover {
      background-color: #f7a600;
    }
    .empty-msg {
      text-align: center;
      margin-top: 50px;
      color: #888;
      font-size: 1.2rem;
    }
  </style>
</head>
<body>

  <h1>Your Cart</h1>

  <div id="cart-container"></div>

  <h2>Shipping Address</h2>
  <form class="address-form" id="address-form">
    <label for="fullname">Full Name</label>
    <input type="text" id="fullname" required />

    <label for="addressLine">Address Line</label>
    <input type="text" id="addressLine" required />

    <label for="city">City</label>
    <input type="text" id="city" required />

    <label for="pincode">Pincode</label>
    <input type="text" id="pincode" required pattern="\d{6}" title="6 digit pincode" />

    <label for="state">State</label>
    <input type="text" id="state" required />
  </form>

  <div class="payment-buttons">
    <button onclick="payWithUPI()">Pay with UPI</button>
    <button onclick="payWithNetBanking()">Pay with Net Banking</button>
    <button onclick="payWithRazorpay()">Pay with Razorpay</button>
  </div>

<script>
  // Sample products array; replace with your actual product list or import it
  const products = [
    { id: "briefs", name: "Men’s Briefs", price: 45 },
    { id: "trunks", name: "Men’s Trunks", price: 70 },
    { id: "white-vest", name: "Men’s White Vest", price: 60 },
    { id: "white-vest-short", name: "Men’s White Vest Short Sleeves", price: 75 },
    { id: "colour-vest", name: "Men’s Colour Vest", price: 65 },
    { id: "shorts", name: "Men’s Shorts", price: 199 },
    { id: "cotton-towels", name: "Cotton Towels", price: 50 },
    { id: "cotton-bedsheets", name: "Cotton Bedsheets", price: 140 }
  ];

  const cartContainer = document.getElementById('cart-container');
  let cart = JSON.parse(localStorage.getItem('cart')) || [];

  function renderCart() {
    if (cart.length === 0) {
      cartContainer.innerHTML = '<p class="empty-msg">Your cart is empty.</p>';
      return;
    }

    let html = `<table>
      <thead>
        <tr><th>Product</th><th>Quantity</th><th>Price (₹)</th><th>Total (₹)</th></tr>
      </thead>
      <tbody>`;

    let grandTotal = 0;
    cart.forEach(item => {
      const product = products.find(p => p.id === item.id);
      if (!product) return;

      const total = product.price * item.quantity;
      grandTotal += total;

      html += `<tr>
        <td>${product.name}</td>
        <td>${item.quantity}</td>
        <td>${product.price.toFixed(2)}</td>
        <td>${total.toFixed(2)}</td>
      </tr>`;
    });

    html += `</tbody></table>`;
    html += `<p style="text-align:right; font-weight:bold; font-size:1.2rem;">Grand Total: ₹${grandTotal.toFixed(2)}</p>`;

    cartContainer.innerHTML = html;
  }

  function saveOrderAndRedirect(paymentMethod) {
    const name = document.getElementById("fullname").value.trim();
    const addressLine = document.getElementById("addressLine").value.trim();
    const city = document.getElementById("city").value.trim();
    const pincode = document.getElementById("pincode").value.trim();
    const state = document.getElementById("state").value.trim();

    if (!name || !addressLine || !city || !pincode || !state) {
      alert("Please fill in all address fields.");
      return;
    }

    if (!/^\d{6}$/.test(pincode)) {
      alert("Please enter a valid 6-digit pincode.");
      return;
    }

    if (cart.length === 0) {
      alert("Your cart is empty.");
      return;
    }

    const fullAddress = `${name}, ${addressLine}, ${city}, ${pincode}, ${state}`;

    // Prepare order items with full details
    const orderedItems = cart.map(cartItem => {
      const product = products.find(p => p.id === cartItem.id);
      return {
        id: product.id,
        name: product.name,
        price: product.price,
        quantity: cartItem.quantity
      };
    });

    // Save order data
    const orderData = {
      address: fullAddress,
      items: orderedItems,
      paymentMethod: paymentMethod,
      orderDate: new Date().toISOString()
    };
    localStorage.setItem('orderData', JSON.stringify(orderData));

    // Clear cart
    localStorage.removeItem('cart');

    alert(`Thank you! Your order will be processed.\n\nShipping to:\n${fullAddress}\nPayment Method: ${paymentMethod}`);

    // Redirect to order summary page
    window.location.href = "order-summary.html";
  }

  function payWithUPI() {
    saveOrderAndRedirect('UPI');
  }

  function payWithNetBanking() {
    saveOrderAndRedirect('Net Banking');
  }

  function payWithRazorpay() {
    saveOrderAndRedirect('Razorpay');
  }

  renderCart();
</script>

</body>
</html>
